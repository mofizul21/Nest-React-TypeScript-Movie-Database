{"ast":null,"code":"import _slicedToArray from \"D:\\\\nestJS\\\\movie-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\nestJS\\\\movie-frontend\\\\src\\\\components\\\\Home.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { useAuth0 } from '../contexts/auth0-context';\n\nfunction Home() {\n  let history = useHistory();\n\n  const _useAuth = useAuth0(),\n        isAuthenticated = _useAuth.isAuthenticated,\n        getIdTokenClaims = _useAuth.getIdTokenClaims,\n        user = _useAuth.user;\n\n  const _useState = useState(),\n        _useState2 = _slicedToArray(_useState, 2),\n        posts = _useState2[0],\n        setPosts = _useState2[1];\n\n  const deletePost = async id => {\n    const accessToken = await getIdTokenClaims();\n    await fetch(`${process.env.REACT_APP_SERVER_BASE_URL}/movie/delete?postID=${id}`, {\n      method: \"delete\",\n      headers: new Headers({\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        \"authorization\": `Bearer ${accessToken.__raw}`\n      })\n    });\n\n    _removePostFromView(id);\n\n    history.push('/');\n  };\n\n  const _removePostFromView = id => {\n    const index = posts.findIndex(post => post._id === id);\n    posts.splice(index, 1);\n  };\n\n  useEffect(() => {\n    const fetchPosts = async () => {\n      const response = await fetch(`${process.env.REACT_APP_SERVER_BASE_URL}/blog/posts`);\n      const json = await response.json();\n      setPosts(json);\n    };\n\n    fetchPosts();\n  }, []);\n  return React.createElement(\"section\", {\n    className: \"blog-area section\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }, posts && posts.map(post => React.createElement(\"div\", {\n    className: \"col-lg-4 col-md-6\",\n    key: post._id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"card h-100\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"single-post post-style-1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"blog-image\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: \"https://res.cloudinary.com/yemiwebby-com-ng/image/upload/v1563149789/blog-image_psvipq.jpg\",\n    alt: \"Blog\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50\n    },\n    __self: this\n  })), React.createElement(\"span\", {\n    className: \"avatar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: \"http://res.cloudinary.com/yemiwebby-com-ng/image/upload/v1513770253/WEB_FREAK_50PX-01_yaqxg7.png\",\n    alt: \"Profile\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"blog-info\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    className: \"title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, post.title))))), React.createElement(\"ul\", {\n    className: \"post-footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }, React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, React.createElement(Link, {\n    to: `/post/${post._id}`,\n    className: \"btn btn-sm btn-outline-secondary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, \"View Post \")), React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, isAuthenticated && user.name === post.author && React.createElement(Link, {\n    to: `/edit/${post._id}`,\n    className: \"btn btn-sm btn-outline-secondary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, \"Edit Post \")), React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, isAuthenticated && user.name === post.author && React.createElement(\"button\", {\n    className: \"btn btn-sm btn-outline-secondary\",\n    onClick: () => deletePost(post._id),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, \"Delete Post\")))))))));\n}\n\nexport default Home;","map":{"version":3,"sources":["D:/nestJS/movie-frontend/src/components/Home.tsx"],"names":["React","useState","useEffect","Link","useHistory","useAuth0","Home","history","isAuthenticated","getIdTokenClaims","user","posts","setPosts","deletePost","id","accessToken","fetch","process","env","REACT_APP_SERVER_BASE_URL","method","headers","Headers","Accept","__raw","_removePostFromView","push","index","findIndex","post","_id","splice","fetchPosts","response","json","map","title","name","author"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { useAuth0 } from '../contexts/auth0-context';\n\n\nfunction Home():JSX.Element {\n  let history = useHistory()\n  const { isAuthenticated, getIdTokenClaims, user } = useAuth0();\n\n  const [posts, setPosts] = useState();\n\n  const deletePost = async(id: string) => {\n    const accessToken = await getIdTokenClaims();\n    await fetch(`${process.env.REACT_APP_SERVER_BASE_URL}/movie/delete?postID=${id}`, {\n      method: \"delete\",\n      headers: new Headers({\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        \"authorization\": `Bearer ${accessToken.__raw}`\n      })\n    });\n    _removePostFromView(id);\n    history.push('/');\n  }\n\n  const _removePostFromView = (id: string) => {\n    const index = posts.findIndex((post: { _id: string; }) => post._id === id);\n    posts.splice(index, 1);\n  }\n\n  useEffect(() => {\n    const fetchPosts = async (): Promise<any> => {\n      const response = await fetch(`${process.env.REACT_APP_SERVER_BASE_URL}/blog/posts`);\n      const json = await response.json();\n      setPosts(json)\n    }\n    fetchPosts();\n  }, [])\n\n    return (\n        <section className=\"blog-area section\">\n        <div className=\"container\">\n          <div className=\"row\">\n            {posts && posts.map((post: { title: React.ReactNode; _id: any; author: any; }) => (\n              <div className=\"col-lg-4 col-md-6\" key={post._id}>\n              <div className=\"card h-100\">\n                <div className=\"single-post post-style-1\">\n\n                  <div className=\"blog-image\">\n                    <img src=\"https://res.cloudinary.com/yemiwebby-com-ng/image/upload/v1563149789/blog-image_psvipq.jpg\" alt=\"Blog\" />\n                  </div>\n\n                  <span className=\"avatar\">\n                    <img src=\"http://res.cloudinary.com/yemiwebby-com-ng/image/upload/v1513770253/WEB_FREAK_50PX-01_yaqxg7.png\" alt=\"Profile\" />\n                  </span>\n\n                  <div className=\"blog-info\">\n\n                    <h4 className=\"title\">\n                      <span>\n                        <b>{post.title}</b>\n                      </span>\n                    </h4>\n                  </div>\n                </div>\n\n                <ul className=\"post-footer\">\n                  <li>\n                    <Link to={`/post/${post._id}`} className=\"btn btn-sm btn-outline-secondary\">View Post </Link>\n                  </li>\n                  <li>\n                    {\n                      isAuthenticated && (user.name === post.author) &&\n                      <Link to={`/edit/${post._id}`} className=\"btn btn-sm btn-outline-secondary\">Edit Post </Link>\n                    }\n                  </li>\n                  <li>\n                    {\n                      isAuthenticated && (user.name === post.author) &&\n                      <button className=\"btn btn-sm btn-outline-secondary\" onClick={() => deletePost(post._id)}>Delete Post</button>\n                    }\n                  </li>\n                </ul>\n              </div>\n            </div>\n            ))}\n          </div>\n        </div>\n      </section>\n    );\n}\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}