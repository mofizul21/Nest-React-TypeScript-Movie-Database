{"ast":null,"code":"import _slicedToArray from \"D:\\\\nestJS\\\\movie-frontend\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"D:\\\\nestJS\\\\movie-frontend\\\\src\\\\components\\\\Home.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { useAuth0 } from '../contexts/auth0-context';\n\nfunction Home() {\n  let history = useHistory();\n\n  const _useAuth = useAuth0(),\n        isAuthenticated = _useAuth.isAuthenticated,\n        getIdTokenClaims = _useAuth.getIdTokenClaims,\n        user = _useAuth.user;\n\n  const _useState = useState(),\n        _useState2 = _slicedToArray(_useState, 2),\n        movies = _useState2[0],\n        setMovies = _useState2[1];\n\n  const deleteMovie = async id => {\n    const accessToken = await getIdTokenClaims();\n    await fetch(`${process.env.REACT_APP_SERVER_BASE_URL}/movie/delete?postID=${id}`, {\n      method: \"delete\",\n      headers: new Headers({\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        \"authorization\": `Bearer ${accessToken.__raw}`\n      })\n    });\n\n    _removeMovieFromView(id);\n\n    history.push('/');\n  };\n\n  const _removeMovieFromView = id => {\n    const index = movies.findIndex(movie => movie._id === id);\n    movies.splice(index, 1);\n  };\n\n  useEffect(() => {\n    const fetch = async () => {\n      const response = await fetch(`${process.env.REACT_APP_SERVER_BASE_URL}/movie/movies`);\n      const json = await response.json();\n      setMovies(json);\n    };\n\n    fetch();\n  }, []);\n  return React.createElement(\"section\", {\n    className: \"blog-area section\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 44\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45\n    },\n    __self: this\n  }, movies && movies.map(movie => React.createElement(\"div\", {\n    className: \"col-lg-4 col-md-6\",\n    key: movie._id,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"card h-100\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"single-post post-style-1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"blog-image\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: \"https://res.cloudinary.com/yemiwebby-com-ng/image/upload/v1563149789/blog-image_psvipq.jpg\",\n    alt: \"Blog\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52\n    },\n    __self: this\n  })), React.createElement(\"span\", {\n    className: \"avatar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 55\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    src: \"http://res.cloudinary.com/yemiwebby-com-ng/image/upload/v1513770253/WEB_FREAK_50PX-01_yaqxg7.png\",\n    alt: \"Profile\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"blog-info\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, React.createElement(\"h4\", {\n    className: \"title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, React.createElement(\"b\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, movie.title))))), React.createElement(\"ul\", {\n    className: \"post-footer\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, React.createElement(Link, {\n    to: `/movie/${movie._id}`,\n    className: \"btn btn-sm btn-outline-secondary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, \"View Movie \")), React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73\n    },\n    __self: this\n  }, isAuthenticated && user.name === movie.author && React.createElement(Link, {\n    to: `/edit/${movie._id}`,\n    className: \"btn btn-sm btn-outline-secondary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76\n    },\n    __self: this\n  }, \"Edit Movie \")), React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, isAuthenticated && user.name === movie.author && React.createElement(\"button\", {\n    className: \"btn btn-sm btn-outline-secondary\",\n    onClick: () => deleteMovie(movie._id),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, \"Delete Movie\")))))))));\n}\n\nexport default Home;","map":{"version":3,"sources":["D:/nestJS/movie-frontend/src/components/Home.tsx"],"names":["React","useState","useEffect","Link","useHistory","useAuth0","Home","history","isAuthenticated","getIdTokenClaims","user","movies","setMovies","deleteMovie","id","accessToken","fetch","process","env","REACT_APP_SERVER_BASE_URL","method","headers","Headers","Accept","__raw","_removeMovieFromView","push","index","findIndex","movie","_id","splice","response","json","map","title","name","author"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useHistory } from 'react-router-dom';\nimport { useAuth0 } from '../contexts/auth0-context';\n\n\nfunction Home():JSX.Element {\n  let history = useHistory()\n  const { isAuthenticated, getIdTokenClaims, user } = useAuth0();\n\n  const [movies, setMovies] = useState();\n\n  const deleteMovie = async(id: string) => {\n    const accessToken = await getIdTokenClaims();\n    await fetch(`${process.env.REACT_APP_SERVER_BASE_URL}/movie/delete?postID=${id}`, {\n      method: \"delete\",\n      headers: new Headers({\n        \"Content-Type\": \"application/json\",\n        Accept: \"application/json\",\n        \"authorization\": `Bearer ${accessToken.__raw}`\n      })\n    });\n    _removeMovieFromView(id);\n    history.push('/');\n  }\n\n  const _removeMovieFromView = (id: string) => {\n    const index = movies.findIndex((movie: { _id: string; }) => movie._id === id);\n    movies.splice(index, 1);\n  }\n\n  useEffect(() => {\n    const fetch = async (): Promise<any> => {\n      const response = await fetch(\n\t\t\t`${process.env.REACT_APP_SERVER_BASE_URL}/movie/movies`\n\t\t);\n      const json = await response.json();\n      setMovies(json)\n    }\n    fetch();\n  }, [])\n\n    return (\n        <section className=\"blog-area section\">\n        <div className=\"container\">\n          <div className=\"row\">\n            {movies && movies.map((movie: { title: React.ReactNode; _id: any; author: any; }) => (\n              <div className=\"col-lg-4 col-md-6\" key={movie._id}>\n              <div className=\"card h-100\">\n                <div className=\"single-post post-style-1\">\n\n                  <div className=\"blog-image\">\n                    <img src=\"https://res.cloudinary.com/yemiwebby-com-ng/image/upload/v1563149789/blog-image_psvipq.jpg\" alt=\"Blog\" />\n                  </div>\n\n                  <span className=\"avatar\">\n                    <img src=\"http://res.cloudinary.com/yemiwebby-com-ng/image/upload/v1513770253/WEB_FREAK_50PX-01_yaqxg7.png\" alt=\"Profile\" />\n                  </span>\n\n                  <div className=\"blog-info\">\n\n                    <h4 className=\"title\">\n                      <span>\n                        <b>{movie.title}</b>\n                      </span>\n                    </h4>\n                  </div>\n                </div>\n\n                <ul className=\"post-footer\">\n                  <li>\n                    <Link to={`/movie/${movie._id}`} className=\"btn btn-sm btn-outline-secondary\">View Movie </Link>\n                  </li>\n                  <li>\n                    {\n                      isAuthenticated && (user.name === movie.author) &&\n                      <Link to={`/edit/${movie._id}`} className=\"btn btn-sm btn-outline-secondary\">Edit Movie </Link>\n                    }\n                  </li>\n                  <li>\n                    {\n                      isAuthenticated && (user.name === movie.author) &&\n                      <button className=\"btn btn-sm btn-outline-secondary\" onClick={() => deleteMovie(movie._id)}>Delete Movie</button>\n                    }\n                  </li>\n                </ul>\n              </div>\n            </div>\n            ))}\n          </div>\n        </div>\n      </section>\n    );\n}\n\nexport default Home;\n"]},"metadata":{},"sourceType":"module"}